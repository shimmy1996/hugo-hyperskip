{{ with .Site.Data.comments.comments }}
{{ range sort (where . "uri" $.Page.RelPermalink) "time" }}
{{ $timestamp := .time.Format "2006-01-02T15:04:05-07:00" }}
{{ $hash := print .name $timestamp | md5 | last 7 }}
<hr/>
<div id="{{ $hash }}">
  <b>{{ or .name (i18n "hyperskip-name-default") }}</b>&nbsp;
  {{- if eq (.email_hash | last 10) ($.Site.Author.email | sha256 | last 10) -}}
  âœ¦
  {{- else -}}
  <code>{{ .email_hash | last 10 }}</code>
  {{- end -}}
  &nbsp;
  <span style="float:right;">
    <a href="#{{ $hash }}">#{{ $hash }}</a>&nbsp;&#91;&nbsp;<a href="#comment" onclick="reply({{ $hash }})">
      {{- i18n "hyperskip-reply" -}}
    </a>&nbsp;&#93;
  </span>
  <br/>
  <time datetime={{ $timestamp }}>{{ $timestamp }}</time>
  <div style="margin-top:1em;">{{ .content | htmlEscape | markdownify }}</div>
</div>
{{ end }}
<script>
  function reply(hash) {
      document.forms.comment_form.comment.value += "[>>" + hash + "](#" + hash + ")\n";
  }
</script>
{{ end }}
